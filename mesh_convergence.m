clear all;
close all;
clc;

%% Euler-Bernoulli
Euler = 0.001190476190476;

%% MATLAB

CST_dofs = [30,594,2142,2222,3402,5022,8282,10302,12322,14762,17182,19602,22842,24462,25662];
CST = [1.489594775595639e-04,0.001064951716968,0.001165059242005,0.001190388895012,0.001200283991053,...
    0.001203717354782,0.001213720937214,0.001214289517394,0.001214598443731,0.001219601547756,0.001219790119117,...
    0.001219912491413,0.001223069785971,0.001224238175844,0.001223154500608];

LST_dofs = [90,650,1394,1734,2142,2730,3402,4290,6666,8282,10302,10578,13202,15778,16422,20502,20898,20930,26082];
LST = [0.001363482660013,0.001395035529096,0.001392014990965,0.001412019295893,0.001362374920909,0.001384481393102,...
    0.001398571095398,0.001308427179395,0.001330708354128,0.001304366004828,0.001282749399446,0.001313490942182,...
    0.001319996006625,0.001302358044489,0.001297014379057,0.001301927429989,0.001262376654595,0.001280249347114,0.001267409217244];


TR_dofs = [105,891,2583,4095,9963,12423,15453,18513,22143,25545];
TR = [3.055855252914182e-04,0.001096762300234,0.001151110756730,0.001197741821396,0.001211703000320,...
    0.001219183865479,0.001219542219717,0.001223723184922,0.001223937663794,0.001225441416596];


%% ABAQUS

LST_dofs_A = [90,594,2210,8514,13202,20930,26082];
LST_A = [0.00118263,0.00122808,0.00123029,0.00123223,0.00123285,0.0012329,0.00123291];

CST_dofs_A = [30,594,2210,5346,10302,20930];
CST_A = [0.000148959,0.00106495,0.00118384,0.00120405,0.00121429,0.00122499];


%% Figures

figure;
semilogx(1./CST_dofs,CST./Euler,'*-',1./CST_dofs_A,CST_A./Euler,'o-',1./LST_dofs,...
    LST./Euler,'*-',1./LST_dofs_A,LST_A./Euler,'o-',1./TR_dofs,TR./Euler,'*-');
grid on;
xlabel('1/DOFs'); ylabel('FE/EB');
title('Midspan vertical displacement');
legend('MATLAB CST','ABAQUS CST','MATLAB LST','ABAQUS LST','MATLAB TR');