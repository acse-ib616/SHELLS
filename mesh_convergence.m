clear all;
close all;
clc;

%% Euler-Bernoulli
Euler = 0.001190476190476;

%% MATLAB

CST_dofs = [30,594,2222,3402,5022,8282,10302,12322,14762,17182,19602,22842,24462,25662];
CST = [1.489594775595639e-04,0.001064951716968,0.001190388895012,0.001200283991053,...
    0.001203717354782,0.001213720937214,0.001214289517394,0.001214598443731,0.001219601547756,0.001219790119117,...
    0.001219912491413,0.001223069785971,0.001224238175844,0.001223154500608];

LST_dofs = [90,450,1066,4050,15778,20930,26082];
LST = [0.001182631300959,0.001226797307065,0.001228936101706,0.001230944439497,0.001232875908865,0.001232897812417,0.001232906522802];


TR_dofs = [81,567,3843,8019,14883,18513,24633];
TR = [3.720323776394732e-04,9.187284504480370e-04,0.001184102288880,0.001205424706547,0.001220006630046,0.001220504038096,0.001225785463890];


%% ABAQUS

LST_dofs_A = [90,594,2210,8514,13202,20930,26082];
LST_A = [0.00118263,0.00122808,0.00123029,0.00123223,0.00123285,0.0012329,0.00123291];

CST_dofs_A = [30,594,2210,5346,10302,20930];
CST_A = [0.000148959,0.00106495,0.00118384,0.00120405,0.00121429,0.00122499];


%% Figures

figure;
semilogx(1./CST_dofs,CST./Euler,'*-',1./CST_dofs_A,CST_A./Euler,'o-',1./LST_dofs,...
    LST./Euler,'*-',1./LST_dofs_A,LST_A./Euler,'o-',1./TR_dofs,TR./Euler,'*-');
grid on;
xlabel('1/DOFs'); ylabel('FE/EB');
title('Midspan vertical displacement');
legend('MATLAB CST','ABAQUS CST','MATLAB LST','ABAQUS LST','MATLAB TR');