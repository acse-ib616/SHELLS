function k = k_mat2(x1,x2,x3,x4,x5,x6,y1,y2,y3,y4,y5,y6,nu,r,s)

t1 = 4;
t2 = t1 .* (s + r) - 3;
t3 = t1 .* r;
t4 = -1 + t3;
t5 = -8 .* r + t1 .* (1 - s);
t6 = t2 .* y1;
t7 = t1 .* s .* (y5 - y6) + t4 .* y2 + t5 .* y4 + t6;
t8 = t1 .* s;
t9 = -1 + t8;
t10 = t1 .* (1 - r) - 8 .* s;
t6 = -t1 .* r .* (y4 - y5) + t10 .* y6 + t9 .* y3 + t6;
t11 = t2 .* (t7 - t6);
t12 = t2 .* x1;
t13 = t1 .* s .* (x5 - x6) + t4 .* x2 + t5 .* x4 + t12;
t12 = -t1 .* r .* (x4 - x5) + t10 .* x6 + t9 .* x3 + t12;
t2 = t2 .* (t13 - t12);
t14 = -nu + 1;
t15 = t2 .^ 2;
t16 = t11 .^ 2;
t17 = t14 / 0.2e1;
t18 = nu + t17;
t19 = -t11 .* t2 .* t18;
t20 = t2 .* t12;
t21 = -t4 .* ((t11 .* t6) + t20 .* t17);
t22 = t11 .* nu;
t23 = t17 .* t2;
t24 = t4 .* ((t22 .* t12) + t23 .* t6);
t25 = t9 .* ((t11 .* t7) + t23 .* t13);
t26 = -t9 .* ((t22 .* t13) + t23 .* t7);
t27 = t3 .* t7 + t5 .* t6;
t3 = -t12 .* t5 - t3 .* t13;
t5 = (-(t11 .* t27) + t23 .* t3);
t28 = -(t22 .* t3) + t23 .* t27;
t29 = r .* t7 - s .* t6;
t30 = r .* t13 - s .* t12;
t31 = 2 .* t2 .* t14;
t32 = t1 .* t11 .* t29 + t31 .* t30;
t31 = -t22 .* t1 .* t30 - t31 .* t29;
t33 = -t10 .* t7 - t8 .* t6;
t8 = t10 .* t13 + t8 .* t12;
t10 = (-(t11 .* t33) + t23 .* t8);
t22 = (-(t22 .* t8) + t23 .* t33);
t23 = (t2 .* nu);
t34 = t17 .* t11;
t35 = t4 .* (t34 .* t12 + t23 .* t6);
t20 = -(t4 .* (t34 .* t6 + t20));
t36 = -t9 .* (t34 .* t13 + t23 .* t7);
t37 = t9 .* ((t13 .* t2) + t34 .* t7);
t38 = t23 .* t27 - t34 .* t3;
t39 = (t2 .* t3) - t34 .* t27;
t11 = 2 .* t11 .* t14;
t40 = -t23 .* t1 .* t29 - (t11 .* t30);
t11 = t1 .* t2 .* t30 + t11 .* t29;
t23 = t23 .* t33 - t34 .* t8;
t2 = ((t2 .* t8) - t34 .* t33);
t34 = (t6 .^ 2);
t41 = t4 .^ 2;
t42 = t12 .^ 2;
t43 = -t6 .* t41 .* t12 .* t18;
t44 = t12 .* t13;
t45 = t4 .* t9;
t46 = -t45 .* (t44 .* t17 + (t6 .* t7));
t47 = nu .* t6;
t48 = t17 .* t12;
t49 = t45 .* ((t47 .* t13) + t48 .* t7);
t50 = t4 .* ((t27 .* t6) - t48 .* t3);
t51 = t4 .* (-t48 .* t27 + (t47 .* t3));
t52 = 2 .* t12 .* t14;
t53 = -t4 .* (t1 .* t6 .* t29 + t52 .* t30);
t52 = t4 .* (t47 .* t1 .* t30 + t52 .* t29);
t54 = t4 .* ((t33 .* t6) - t48 .* t8);
t47 = (t4 .* (-t48 .* t33 + (t47 .* t8)));
t48 = (nu .* t12);
t55 = t17 .* t6;
t56 = t45 .* (t55 .* t13 + t48 .* t7);
t44 = -(t45 .* (t55 .* t7 + t44));
t45 = (t4 .* (-t48 .* t27 + t55 .* t3));
t57 = t4 .* (-(t12 .* t3) + t55 .* t27);
t6 = 2 .* t6 .* t14;
t58 = t4 .* (t48 .* t1 .* t29 + (t6 .* t30));
t6 = -t4 .* (t1 .* t12 .* t30 + t6 .* t29);
t48 = t4 .* (-t48 .* t33 + t55 .* t8);
t4 = (t4 .* (-(t8 .* t12) + t55 .* t33));
t12 = t7 .^ 2;
t55 = (t9 .^ 2);
t59 = t13 .^ 2;
t60 = -t55 .* t7 .* t13 .* t18;
t61 = t3 .* t13;
t62 = t9 .* (t61 .* t17 - (t27 .* t7));
t63 = nu .* t7;
t64 = t17 .* t13;
t65 = t9 .* (t64 .* t27 - (t63 .* t3));
t66 = 2 .* t13 .* t14;
t67 = t9 .* (t1 .* t7 .* t29 + t66 .* t30);
t66 = -t9 .* (t63 .* t1 .* t30 + t66 .* t29);
t68 = t9 .* (-(t33 .* t7) + t64 .* t8);
t63 = (t9 .* (t64 .* t33 - (t63 .* t8)));
t64 = (nu .* t13);
t69 = t17 .* t7;
t70 = t9 .* (t64 .* t27 - t69 .* t3);
t61 = (t9 .* (-t69 .* t27 + t61));
t7 = 2 .* t7 .* t14;
t71 = -t9 .* (t64 .* t1 .* t29 + (t7 .* t30));
t7 = t9 .* (t1 .* t13 .* t30 + t7 .* t29);
t64 = t9 .* (t64 .* t33 - t69 .* t8);
t9 = (t9 .* ((t13 .* t8) - t69 .* t33));
t13 = t3 .^ 2;
t69 = (t27 .^ 2);
t72 = t27 .* t3 .* t18;
t73 = 2 .* t3 .* t14;
t74 = t1 .* t27;
t75 = -t74 .* t29 + t73 .* t30;
t73 = t74 .* nu .* t30 - t73 .* t29;
t74 = t3 .* t8;
t76 = t74 .* t17 + (t27 .* t33);
t77 = (nu .* t27 .* t8) + t17 .* t3 .* t33;
t78 = t1 .* t3;
t79 = 2 .* t27 .* t14;
t80 = -t78 .* nu .* t29 + t79 .* t30;
t78 = -t79 .* t29 + t78 .* t30;
t27 = (t17 .* t27);
t3 = nu .* t3 .* t33 + t27 .* t8;
t27 = t27 .* t33 + t74;
t74 = t30 .^ 2;
t79 = t29 .^ 2;
t81 = 8 .* t14;
t82 = -t30 .* t29 .* (16 .* nu + t81);
t83 = 2 .* t30 .* t14;
t84 = t1 .* t29;
t85 = -t84 .* t33 + t83 .* t8;
t83 = -t84 .* nu .* t8 + t83 .* t33;
t14 = 2 .* t29 .* t14;
t1 = t1 .* t30;
t29 = t1 .* nu .* t33 - t14 .* t8;
t1 = t1 .* t8 - t14 .* t33;
t14 = t8 .^ 2;
t30 = t33 .^ 2;
t8 = (t33 .* t8 .* t18);
integ = [t17 .* t15 + t16 t19 t21 t24 t25 t26 t5 t28 t32 t31 t10 t22; t19 t17 .* t16 + t15 t35 t20 t36 t37 t38 t39 t40 t11 t23 t2; t21 t35 t41 .* (t17 .* t42 + t34) t43 t46 t49 t50 t51 t53 t52 t54 t47; t24 t20 t43 t41 .* (t17 .* t34 + t42) t56 t44 t45 t57 t58 t6 t48 t4; t25 t36 t46 t56 t55 .* (t17 .* t59 + t12) t60 t62 t65 t67 t66 t68 t63; t26 t37 t49 t44 t60 t55 .* (t17 .* t12 + t59) t70 t61 t71 t7 t64 t9; t5 t38 t50 t45 t62 t70 t17 .* t13 + t69 t72 t75 t73 t76 t77; t28 t39 t51 t57 t65 t61 t72 t17 .* t69 + t13 t80 t78 t3 t27; t32 t40 t53 t58 t67 t71 t75 t80 t81 .* t74 + 16 .* t79 t82 t85 t83; t31 t11 t52 t6 t66 t7 t73 t78 t82 t81 .* t79 + 16 .* t74 t29 t1; t10 t23 t54 t48 t68 t64 t76 t3 t85 t29 t17 .* t14 + t30 t8; t22 t2 t47 t4 t63 t9 t77 t27 t83 t1 t8 t17 .* t30 + t14;];
 
%% Jacobian determinant
 
t7 = 16 .* y2;
t8 = 32 .* y5;
t9 = 32 .* y6;
t12 = 32 .* y4;
t15 = 16 .* x2;
t16 = 32 .* x5;
t23 = x2 .* y6;
t26 = (r .^ 2);
t28 = 16 .* y3;
t31 = 16 .* x3;
t44 = x3 .* y2;
t46 = x2 .* y3;
t48 = x3 .* y4;
t53 = 4 .* y3;
t54 = 28 .* y4;
t55 = 12 .* y5;
t56 = 28 .* y6;
t59 = 4 .* x3;
t60 = 28 .* x4;
t61 = 12 .* x5;
t62 = 28 .* x6;
t65 = 4 .* y2;
t67 = 16 .* y5;
t68 = 48 .* y6;
t72 = 48 .* y4;
t75 = 4 .* x2;
t77 = 16 .* x5;
t102 = x5 .* y3;
t107 = (s .^ 2);
t150 = t26 .* ((-16 .* y2 + 16 .* y4 + 16 .* y5 - 16 .* y6) .* x1 + (16 .* x2 - 16 .* x4 - 16 .* x5 + 16 .* x6) .* y1 + x4 .* (t7 - t8 + t9) + x6 .* (t7 - t12) + y4 .* (-t15 + t16) - 16 .* x5 .* y2 + 16 .* x2 .* y5 - 16 .* t23) + r .* (s .* (x1 .* (-t7 + t28 + t12 - t9) + y1 .* (t15 - t31 - 32 .* x4 + 32 .* x6) + (-32 .* y3 + 64 .* y6) .* x4 + (32 .* y2 - 64 .* y4) .* x6 - 16 .* t44 + 16 .* t46 + 32 .* t48 - 32 .* t23) + x1 .* (t7 - t53 - t54 - t55 + t56) + y1 .* (-t15 + t59 + t60 + t61 - t62) + x4 .* (-t65 + 8 .* y3 + t67 - t68) + x6 .* (-20 .* y2 + t72) + y4 .* (t75 - 8 .* x3 - t77) + 20 .* t23 + (-4 .* y3 - 4 .* y5) .* x2 + 4 .* y2 .* (x3 + x5)) + t107 .* ((16 .* y3 + 16 .* y4 - 16 .* y5 - 16 .* y6) .* x1 + (-16 .* x3 - 16 .* x4 + 16 .* x5 + 16 .* x6) .* y1 + x4 .* (-t28 + t9) + x6 .* (-t28 - t12 + t8) + 16 .* t48 + y6 .* (t31 - t16) + 16 .* t102 - 16 .* x3 .* y5) + s .* (x1 .* (t65 - t28 - t54 + t55 + t56) + y1 .* (-t75 + t31 + t60 - t61 - t62) + x4 .* (20 .* y3 - t68) + x6 .* (-8 .* y2 + t53 + t72 - t67) - 20 .* t48 + y6 .* (8 .* x2 - t59 + t77) - 4 .* t46 + (4 .* y2 + 4 .* y5) .* x3 - 4 .* t102) + (-3 .* y2 + 3 .* y3 + 12 .* y4 - 12 .* y6) .* x1 + (3 .* x2 - 3 .* x3 - 12 .* x4 + 12 .* x6) .* y1 + x4 .* (-t53 + 16 .* y6) + x6 .* (t65 - 16 .* y4) - t44 + t46 + 4 .* t48 - 4 .* t23;
J = 1 / t150;

k = J.*integ;