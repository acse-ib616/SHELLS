% Using Lecture_4_2Dtruss by Dr. Sadowski as a template
clear all;
close all;
clc;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% PRE-PROCESSOR MODULE %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Parameters
E = 42e9; % N/m2 - modulus of elasticity of each bar element
nu = 0.2; % Poisson coefficient
t = 0.05; % Element thickness in m

% Specifying nodal x-y coordinates
NODES.coords = [0   0 ; % node 1 - x,y coordinates
                2   0 ; % node 2 - x,y coordinates
                4   0 ; % node 3 - x,y coordinates
                6   0 ; % node 4 - x,y coordinates
                8   0 ; % node 5 - x,y coordinates
                10  0 ;
                0   1 ;
                2   1 ;
                4   1 ;
                6   1 ;
                8   1 ;
                10  1 ; % node 12 - x,y coordinates
                1   0 ;
                3   0 ;
                5   0 ;
                7   0 ;
                9   0 ;
                0  0.5;
                1  0.5;
                2  0.5;
                3  0.5;
                4  0.5;
                5  0.5;
                6  0.5;
                7  0.5;
                8  0.5;
                9  0.5;
                10 0.5;
                1   1 ;
                3   1 ;
                5   1 ;
                7   1 ;
                9   1 ]; % node 33 - x,y coordinates
NODES.dofs = [1   2 ;  % node 1 - dofs u1,v1 (1,2) - FIXED  
              3   4 ;  % node 2 - dofs u2,v2 (3,4) - FIXED
              5   6 ;  % node 3 - dofs u3,v3 (5,6) - FIXED
              7   8 ;  % node 4 - dofs u4,v4 (7,8) - FIXED
              9  10 ;
              11 12 ;
              13 14 ;
              15 16 ;
              17 18 ;
              19 20 ;
              21 22 ;
              23 24 ;
              25 26 ;
              27 28 ;
              29 30 ;
              31 32 ;
              33 34 ;
              35 36 ;
              37 38 ;
              39 40 ;
              41 42 ;
              43 44 ;
              45 46 ;
              47 48 ;
              49 50 ;
              51 52 ;
              53 54 ;
              55 56 ;
              57 58 ;
              59 60 ;
              61 62 ;
              63 64 ;
              65   66 ]; % node 6 - dofs u6,v6 (11,12) - FIXED
% Note that node numbers are identified by their row number
     
% Specifying element nodal connectivity (order does not matter)
ELEMENTS = [1 2 8 13 20 19 ; % element 1 - element dofs u1,v1,u3,v3 (1,2,5,6)
            2 3 9 14 22 21 ; % element 2 - element dofs u2,v2,u3,v3 (3,4,5,6)
            3 4 10 15 24 23; % element 3 - element dofs u2,v2,u4,v4 (3,4,7,8)
            4 5 11 16 26 25;
            5 6 12 17 28 27;
            8 7 1 29 18 19 ;
            9 8 2 30 20 21 ;
            10 9 3 31 22 23;
            11 10 4 32 24 25;
            12 11 5 33 26 27]; % element 10 - element dofs u3,v3,u4,v4 (5,6,7,8)

% Degrees of freedom & other parameters
dofs_free = [3:12,15:34,37:66]; % unknown nodal x-y dofs (at nodes 3,4,5)
dofs_restrained = [1,2,13,14,35,36]; % known nodal x-y dofs due to BC (at nodes 1,2)
nodes = size(NODES.coords,1); % no. of nodes i.e. 6
elements = size(ELEMENTS,1); % no. of elements i.e.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% ASSEMBLER MODULE %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Constructing the global stiffness matrix
K = zeros(2*nodes); % initialising en empty 66x66 matrix; 33 nodes at 2 dofs/node
for EL = 1:elements % loop through all elements & build stiffness matrix
    n1 = ELEMENTS(EL,1); n2 = ELEMENTS(EL,2); n3 = ELEMENTS(EL,3); % identify element node numbers
    n4 = ELEMENTS(EL,4); n5 = ELEMENTS(EL,5); n6 = ELEMENTS(EL,6); % identify element node numbers
    x1 = NODES.coords(n1,1); y1 = NODES.coords(n1,2); % element node 1 - x,y coordinates
    x2 = NODES.coords(n2,1); y2 = NODES.coords(n2,2); % element node 2 - x,y coordinates
    x3 = NODES.coords(n3,1); y3 = NODES.coords(n3,2); % element node 3 - x,y coordinates
    
    b = abs(x2-x1); h = abs(y3-y1); % base and height of triangular element
    A = b*h/2; % area of triangle
    
    dof11 = NODES.dofs(n1,1); dof12 = NODES.dofs(n1,2);  % element node 1 - dofs
    dof21 = NODES.dofs(n2,1); dof22 = NODES.dofs(n2,2);  % element node 2 - dofs
    dof31 = NODES.dofs(n3,1); dof32 = NODES.dofs(n3,2);  % element node 3 - dofs
    dof41 = NODES.dofs(n4,1); dof42 = NODES.dofs(n4,2);  % element node 4 - dofs
    dof51 = NODES.dofs(n5,1); dof52 = NODES.dofs(n5,2);  % element node 5 - dofs
    dof61 = NODES.dofs(n6,1); dof62 = NODES.dofs(n6,2);  % element node 6 - dofs
    
    constants = (1 / A * t * E / (-nu ^ 2 + 1)) / 0.2e1; % Constants over element area
    
    x_0 = x1; y_0 = y1; x_1 = x2; y_1 = y3;
    
    cg = [((16 * x_1) - (16 * x_0) + 0.16e2 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.32e2 * h / b + 0.32e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.24e2 * h * (x_1 - x_0) - 0.24e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.16e2 * h ^ 2 / b ^ 2 - 0.8e1 * nu + 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (-0.24e2 * h ^ 2 / b - 0.24e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.9e1 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) + 0.9e1 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) (0.16e2 * b / h * nu * (x_1 - x_0) + 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.16e2 * nu + 0.16e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.24e2 * nu * b * (x_1 - x_0) - 0.24e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.16e2 * nu * h / b + 0.4e1 * (0.2e1 - 0.2e1 * nu) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (-0.24e2 * nu * h - 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) - 0.3e1 * (0.2e1 - 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.9e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) + 0.9e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * h ^ 2 / b ^ 2 * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * h ^ 2 / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) ((-0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.4e1 / 0.3e1 * (0.2e1 - 0.2e1 * nu) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + (-0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) - (0.2e1 - 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.3e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) 0.16e2 / 0.3e1 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.2e1 * (0.2e1 - 0.2e1 * nu) * b / h * (-x_0 ^ 2 + x_1 ^ 2) - 0.16e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - (0.2e1 - 0.2e1 * nu) * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.3e1 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) 0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.8e1 * nu * (-x_0 ^ 2 + x_1 ^ 2) - 0.16e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (16 * x_1 - 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.16e2 * h / b + 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.8e1 * nu + 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 - 0.6e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.6e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (-(16 * x_1) + (16 * x_0) - 0.32e2 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.16e2 * h / b - 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) - 0.8e1 * (0.2e1 - 0.2e1 * nu) * b / h) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.12e2 * h * (x_1 - x_0) + 0.40e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.8e1 * nu - 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * b) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) (-0.32e2 * b / h * nu * (x_1 - x_0) - 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.40e2 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.40e2 * nu * b * (x_1 - x_0) + 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.14e2 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.12e2 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (-16 * x_1 + 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.48e2 * h / b - 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.28e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.32e2 * h ^ 2 / b ^ 2 - 0.8e1 + 0.8e1 * nu) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.40e2 * h ^ 2 / b + 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.8e1 * nu - 0.24e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.28e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.16e2 * nu * h / b - 0.8e1 * (0.2e1 - 0.2e1 * nu) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.12e2 * nu * h + 0.24e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0); (0.16e2 * b / h * nu * (x_1 - x_0) + 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.16e2 * nu + 0.16e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.24e2 * nu * b * (x_1 - x_0) - 0.24e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.16e2 * nu * h / b + 0.4e1 * (0.2e1 - 0.2e1 * nu) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (-0.24e2 * nu * h - 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) - 0.3e1 * (0.2e1 - 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.9e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) + 0.9e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) (0.16e2 * b ^ 2 / h ^ 2 * (x_1 - x_0) + (-0.8e1 * nu + 0.8e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.32e2 * b / h + 0.8e1 * (0.2e1 - 0.2e1 * nu) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.24e2 * b ^ 2 / h * (x_1 - x_0) - 0.24e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.16e2 + 0.16e2 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (-0.24e2 * b - 0.24e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.9e1 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) + 0.9e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * nu * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (0.2e1 * (0.2e1 - 0.2e1 * nu) * h / b * (-x_0 ^ 2 + x_1 ^ 2) - (0.2e1 - 0.2e1 * nu) * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) 0.4e1 / 0.3e1 * (0.2e1 - 0.2e1 * nu) * b / h * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.2e1 * (0.2e1 - 0.2e1 * nu) * (-x_0 ^ 2 + x_1 ^ 2) + (-0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) - (0.2e1 - 0.2e1 * nu) * b) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) 0.16e2 / 0.3e1 * b ^ 2 / h ^ 2 * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.8e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) - 0.16e2 * b ^ 2 / h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) 0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.6e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.4e1 / 0.3e1 * (0.2e1 - 0.2e1 * nu) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.16e2 * b / h + 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) + 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) - 0.6e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (-0.16e2 * b / h * nu * (x_1 - x_0) - 0.8e1 * (0.2e1 - 0.2e1 * nu) * b / h * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.8e1 * nu - 0.24e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.12e2 * nu * b * (x_1 - x_0) + (0.24e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * b) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.14e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) (-0.32e2 * b ^ 2 / h ^ 2 * (x_1 - x_0) - 0.4e1 * (0.2e1 - 0.2e1 * nu) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.48e2 * b / h - 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.40e2 * b ^ 2 / h * (x_1 - x_0) + 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) - 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) + 0.14e2 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.12e2 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.40e2 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.28e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.32e2 * nu * h / b - 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.40e2 * nu * h + 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * nu - 0.8e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.16e2 * b / h - 0.8e1 * (0.2e1 - 0.2e1 * nu) * h / b - 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + (0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * h) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.16e2 - 0.32e2 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.12e2 * b + 0.40e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0); (0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * h ^ 2 / b ^ 2 * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * h ^ 2 / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * nu * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (-h + 0.4e1 * h * x_1 / b) ^ 3 / h * b * (y_1 - y_0) / 0.12e2 - (-h + 0.4e1 * h * x_0 / b) ^ 3 / h * b * (y_1 - y_0) / 0.12e2 0 0 (0.8e1 * nu * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + nu * b * h * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (-0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 (-0.16e2 * nu * (-x_0 ^ 2 + x_1 ^ 2) + 0.8e1 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.10e2 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (-0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.32e2 / 0.3e1 * h ^ 2 / b ^ 2 * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.12e2 * h ^ 2 / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0); ((-0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.4e1 / 0.3e1 * (0.2e1 - 0.2e1 * nu) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + (-0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) - (0.2e1 - 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.3e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) (0.2e1 * (0.2e1 - 0.2e1 * nu) * h / b * (-x_0 ^ 2 + x_1 ^ 2) - (0.2e1 - 0.2e1 * nu) * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) 0 0.16e2 / 0.3e1 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.4e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) (0.2e1 * (0.2e1 - 0.2e1 * nu) * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) 0 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (0.8e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 ((-0.16e2 + 0.16e2 * nu) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.8e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.10e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) (-0.8e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 -0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (-0.8e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.32e2 / 0.3e1 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.12e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0); 0.16e2 / 0.3e1 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.2e1 * (0.2e1 - 0.2e1 * nu) * b / h * (-x_0 ^ 2 + x_1 ^ 2) - 0.16e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - (0.2e1 - 0.2e1 * nu) * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.3e1 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) 0.4e1 / 0.3e1 * (0.2e1 - 0.2e1 * nu) * b / h * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.2e1 * (0.2e1 - 0.2e1 * nu) * (-x_0 ^ 2 + x_1 ^ 2) + (-0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) - (0.2e1 - 0.2e1 * nu) * b) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) 0 (0.2e1 * (0.2e1 - 0.2e1 * nu) * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) 0.16e2 / 0.3e1 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.4e1 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) + b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) 0 0.4e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) - 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) -0.32e2 / 0.3e1 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.8e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) + 0.24e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) -0.4e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.4e1 * (0.2e1 - 0.2e1 * nu) * (-x_0 ^ 2 + x_1 ^ 2) + 0.20e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0); 0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.8e1 * nu * (-x_0 ^ 2 + x_1 ^ 2) - 0.16e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) 0.16e2 / 0.3e1 * b ^ 2 / h ^ 2 * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (0.8e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) - 0.16e2 * b ^ 2 / h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.3e1 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * nu * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + nu * b * h * (x_1 - x_0) * (y_1 - y_0) 0 0 0.16e2 / 0.3e1 * b ^ 2 / h ^ 2 * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.4e1 * b ^ 2 / h * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) + b ^ 2 * (x_1 - x_0) * (y_1 - y_0) 0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.2e1 * nu * b * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) 0.4e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) - 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + 0.2e1 * nu * b * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) -0.32e2 / 0.3e1 * b ^ 2 / h ^ 2 * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.8e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) + 0.24e2 * b ^ 2 / h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.16e2 * nu * (-x_0 ^ 2 + x_1 ^ 2) + 0.20e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.4e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) -0.4e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0); (16 * x_1 - 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.16e2 * h / b + 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.8e1 * nu + 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 - 0.6e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.6e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.4e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) - 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.2e1 * nu * b * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) (16 * x_1 - 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + (-0.8e1 * nu + 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 (0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 (-16 * x_1 + 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 - 0.8e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + (0.8e1 * nu - 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + 0.8e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) -0.32e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.16e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 (-16 * x_1 + 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + (-0.16e2 * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.16e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.8e1 * nu - 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 (-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 - 0.32e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.8e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0); 0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.6e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.4e1 / 0.3e1 * (0.2e1 - 0.2e1 * nu) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.16e2 * b / h + 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) + 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) - 0.6e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (0.8e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) 0.4e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) - 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 -0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) + 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) + 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) -0.32e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.16e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 -0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.8e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) - 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) + 0.8e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 - 0.32e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.8e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.4e1 / 0.3e1 * (-0.2e1 + 0.2e1 * nu) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.16e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) - 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0); (-(16 * x_1) + (16 * x_0) - 0.32e2 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.16e2 * h / b - 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) - 0.8e1 * (0.2e1 - 0.2e1 * nu) * b / h) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.12e2 * h * (x_1 - x_0) + 0.40e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.8e1 * nu - 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * b) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) (-0.16e2 * b / h * nu * (x_1 - x_0) - 0.8e1 * (0.2e1 - 0.2e1 * nu) * b / h * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.8e1 * nu - 0.24e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.12e2 * nu * b * (x_1 - x_0) + (0.24e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * b) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.14e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) (-0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 ((-0.16e2 + 0.16e2 * nu) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.8e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.10e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) -0.32e2 / 0.3e1 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.8e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) + 0.24e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + 0.2e1 * nu * b * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) (-16 * x_1 + 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 - 0.8e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + (0.8e1 * nu - 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + 0.8e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) -0.32e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.16e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 ((16 * x_1) - (16 * x_0) + 0.64e2 * b ^ 2 / h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + (0.32e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) - 0.64e2 * b ^ 2 / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.8e1 * nu + 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 - 0.16e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.16e2 * b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) (0.32e2 * b / h * nu * (x_1 - x_0) + 0.32e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.16e2 * nu * b * (x_1 - x_0) - 0.16e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 (16 * x_1 - 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.32e2 * h / b + 0.32e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.16e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.8e1 * nu + 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 - 0.8e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.32e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.24e2 * nu + 0.40e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.48e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.8e1 / 0.3e1 * (-0.2e1 + 0.2e1 * nu) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + (-0.32e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (-0.2e1 + 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.16e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0); (-0.32e2 * b / h * nu * (x_1 - x_0) - 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.40e2 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.40e2 * nu * b * (x_1 - x_0) + 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.14e2 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.12e2 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (-0.32e2 * b ^ 2 / h ^ 2 * (x_1 - x_0) - 0.4e1 * (0.2e1 - 0.2e1 * nu) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.48e2 * b / h - 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.40e2 * b ^ 2 / h * (x_1 - x_0) + 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) - 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) + 0.14e2 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.12e2 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) (-0.16e2 * nu * (-x_0 ^ 2 + x_1 ^ 2) + 0.8e1 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.10e2 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (-0.8e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 -0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 2 + y_1 ^ 2) -0.32e2 / 0.3e1 * b ^ 2 / h ^ 2 * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.8e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) + 0.24e2 * b ^ 2 / h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) -0.32e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.16e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 -0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) - 0.8e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) - 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) + 0.8e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (0.32e2 * b / h * nu * (x_1 - x_0) + 0.32e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.16e2 * nu * b * (x_1 - x_0) - 0.16e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 (0.64e2 * b ^ 2 / h ^ 2 * (x_1 - x_0) + 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + (0.32e2 * b / h * (-x_0 ^ 2 + x_1 ^ 2) - 0.64e2 * b ^ 2 / h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) + 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) - 0.16e2 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.16e2 * b ^ 2 * (x_1 - x_0) * (y_1 - y_0) 0.32e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.72e2 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.48e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.32e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.24e2 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.16e2 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) -0.4e1 / 0.3e1 * (-0.2e1 + 0.2e1 * nu) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.32e2 * b / h + 0.32e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.16e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) + 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0); (-16 * x_1 + 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.48e2 * h / b - 0.16e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.28e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.32e2 * h ^ 2 / b ^ 2 - 0.8e1 + 0.8e1 * nu) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.40e2 * h ^ 2 / b + 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.40e2 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.28e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.32e2 * nu * h / b - 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.40e2 * nu * h + 0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (-0.8e1 * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.32e2 / 0.3e1 * h ^ 2 / b ^ 2 * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.12e2 * h ^ 2 / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.2e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) -0.4e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + 0.2e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.16e2 * nu * (-x_0 ^ 2 + x_1 ^ 2) + 0.20e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.4e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (-16 * x_1 + 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + (-0.16e2 * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.16e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.8e1 * nu - 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 (-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 - 0.32e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.8e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (16 * x_1 - 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((0.32e2 * h / b + 0.32e2 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.16e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.8e1 * nu + 0.8e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 - 0.8e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.32e2 / 0.3e1 * b / h * nu * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.72e2 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.48e2 * nu * b * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.32e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) - 0.24e2 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.16e2 * nu * b * h * (x_1 - x_0) * (y_1 - y_0) (16 * x_1 - 16 * x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + (0.32e2 * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.32e2 * h * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.64e2 * h ^ 2 / b ^ 2 + 0.8e1 - 0.8e1 * nu) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 - 0.32e2 * h ^ 2 / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.16e2 * h ^ 2 * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 + (0.32e2 * nu * h / b + 0.32e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (-0.16e2 * nu * h - 0.16e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1; -0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.8e1 * nu - 0.24e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + 0.28e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.16e2 * nu * h / b - 0.8e1 * (0.2e1 - 0.2e1 * nu) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.12e2 * nu * h + 0.24e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) (0.8e1 * nu - 0.8e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + ((-0.16e2 * b / h - 0.8e1 * (0.2e1 - 0.2e1 * nu) * h / b - 0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 + (0.12e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (0.2e1 - 0.2e1 * nu) * h) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (-0.16e2 - 0.32e2 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (0.12e2 * b + 0.40e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 - 0.12e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * nu * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.2e1 * nu * h * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (-0.8e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.32e2 / 0.3e1 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.12e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0) -0.16e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.4e1 * (0.2e1 - 0.2e1 * nu) * (-x_0 ^ 2 + x_1 ^ 2) + 0.20e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.4e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) - 0.4e1 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) -0.4e1 * b / h * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) + 0.2e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (-0.8e1 * nu - 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 - 0.32e2 / 0.3e1 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + 0.8e1 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) 0.4e1 / 0.3e1 * (-0.2e1 + 0.2e1 * nu) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + (-0.16e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) + 0.16e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) - 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) 0.32e2 / 0.3e1 * b / h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((-0.24e2 * nu + 0.40e2) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.48e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.8e1 / 0.3e1 * (-0.2e1 + 0.2e1 * nu) * h / b * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) + (-0.32e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) + 0.4e1 * (-0.2e1 + 0.2e1 * nu) * h) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 + 0.16e2 * b * (0.1e1 / 0.2e1 - nu / 0.2e1) * h * (x_1 - x_0) * (y_1 - y_0) -0.4e1 / 0.3e1 * (-0.2e1 + 0.2e1 * nu) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) + ((0.32e2 * b / h + 0.32e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 2 + x_1 ^ 2) / 0.2e1 - 0.16e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 - 0.16e2 / 0.3e1 * (x_0 ^ 3) * (y_1 - y_0) + 0.16e2 / 0.3e1 * (x_1 ^ 3) * (y_1 - y_0) - 0.8e1 * b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) (0.8e1 * nu + 0.8e1) * (-x_0 ^ 2 + x_1 ^ 2) * (-y_0 ^ 2 + y_1 ^ 2) / 0.4e1 + (0.32e2 * nu * h / b + 0.32e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 + (-0.16e2 * nu * h - 0.16e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) / 0.2e1 (-0.8e1 * nu + 0.8e1) * (x_1 - x_0) * (-y_0 ^ 3 + y_1 ^ 3) / 0.3e1 + (0.32e2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * h / b * (-x_0 ^ 2 + x_1 ^ 2) - 0.32e2 * h * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0)) * (-y_0 ^ 2 + y_1 ^ 2) / 0.2e1 + (0.16e2 + 0.64e2 * h ^ 2 / b ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1)) * (-x_0 ^ 3 + x_1 ^ 3) * (y_1 - y_0) / 0.3e1 - 0.32e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) / b * (-x_0 ^ 2 + x_1 ^ 2) * (y_1 - y_0) + 0.16e2 * h ^ 2 * (0.1e1 / 0.2e1 - nu / 0.2e1) * (x_1 - x_0) * (y_1 - y_0)];

    
    
%     alpha = atan2(y2-y1,x2-x1); % angle of inclination relative to the POSITIVE direction of the x axis
    alpha = 0; % In this case we have input the real global coordinates, so tranformation unnecessary 
    c = cos(alpha); s = sin(alpha); % angle parameters
    ke = 0.5*constants*cg; % element stiffness. The 0.5 comes from integrating the area of a triangle (bh/2)
    
    T = c*eye(12) + s*diag(ones(1,11),1) - s*diag(ones(1,11),-1); % Transformation matrix
    
    ke_transformed = T.'*ke*T;
    
    % Updating global stiffness matrix [K] coefficients 
    % Note that for each element you still have to 'think locally'
    % Row 1 - element dof11
    K(dof11,dof11) = K(dof11,dof11) + ke_transformed(1,1); % Col 1 - element dof11
    K(dof11,dof12) = K(dof11,dof12) + ke_transformed(1,2); % Col 2 - element dof12
    K(dof11,dof21) = K(dof11,dof21) + ke_transformed(1,3); % Col 3 - element dof21
    K(dof11,dof22) = K(dof11,dof22) + ke_transformed(1,4); % Col 4 - element dof22
    K(dof11,dof31) = K(dof11,dof31) + ke_transformed(1,5); % Col 5 - element dof31
    K(dof11,dof32) = K(dof11,dof32) + ke_transformed(1,6); % Col 6 - element dof32
    K(dof11,dof41) = K(dof11,dof41) + ke_transformed(1,7); % Col 7 - element dof41
    K(dof11,dof42) = K(dof11,dof42) + ke_transformed(1,8); % Col 8 - element dof42
    K(dof11,dof51) = K(dof11,dof51) + ke_transformed(1,9); % Col 9 - element dof51
    K(dof11,dof52) = K(dof11,dof52) + ke_transformed(1,10); % Col 10 - element dof52
    K(dof11,dof61) = K(dof11,dof61) + ke_transformed(1,11); % Col 11 - element dof61
    K(dof11,dof62) = K(dof11,dof62) + ke_transformed(1,12); % Col 12 - element dof62
    
    % Row 2 - element dof12
    K(dof12,dof11) = K(dof12,dof11) + ke_transformed(2,1); % Col 1 - element dof11
    K(dof12,dof12) = K(dof12,dof12) + ke_transformed(2,2); % Col 2 - element dof12
    K(dof12,dof21) = K(dof12,dof21) + ke_transformed(2,3); % Col 3 - element dof21
    K(dof12,dof22) = K(dof12,dof22) + ke_transformed(2,4); % Col 4 - element dof22
    K(dof12,dof31) = K(dof12,dof31) + ke_transformed(2,5); % Col 5 - element dof31
    K(dof12,dof32) = K(dof12,dof32) + ke_transformed(2,6); % Col 6 - element dof32
    K(dof12,dof41) = K(dof12,dof41) + ke_transformed(2,7); % Col 7 - element dof41
    K(dof12,dof42) = K(dof12,dof42) + ke_transformed(2,8); % Col 8 - element dof42
    K(dof12,dof51) = K(dof12,dof51) + ke_transformed(2,9); % Col 9 - element dof51
    K(dof12,dof52) = K(dof12,dof52) + ke_transformed(2,10); % Col 10 - element dof52
    K(dof12,dof61) = K(dof12,dof61) + ke_transformed(2,11); % Col 11 - element dof61
    K(dof12,dof62) = K(dof12,dof62) + ke_transformed(2,12); % Col 12 - element dof62
    
    % Row 3 - element dof21
    K(dof21,dof11) = K(dof21,dof11) + ke_transformed(3,1); % Col 1 - element dof11
    K(dof21,dof12) = K(dof21,dof12) + ke_transformed(3,2); % Col 2 - element dof12
    K(dof21,dof21) = K(dof21,dof21) + ke_transformed(3,3); % Col 3 - element dof21
    K(dof21,dof22) = K(dof21,dof22) + ke_transformed(3,4); % Col 4 - element dof22
    K(dof21,dof31) = K(dof21,dof31) + ke_transformed(3,5); % Col 5 - element dof31
    K(dof21,dof32) = K(dof21,dof32) + ke_transformed(3,6); % Col 6 - element dof32
    K(dof21,dof41) = K(dof21,dof41) + ke_transformed(3,7); % Col 7 - element dof41
    K(dof21,dof42) = K(dof21,dof42) + ke_transformed(3,8); % Col 8 - element dof42
    K(dof21,dof51) = K(dof21,dof51) + ke_transformed(3,9); % Col 9 - element dof51
    K(dof21,dof52) = K(dof21,dof52) + ke_transformed(3,10); % Col 10 - element dof52
    K(dof21,dof61) = K(dof21,dof61) + ke_transformed(3,11); % Col 11 - element dof61
    K(dof21,dof62) = K(dof21,dof62) + ke_transformed(3,12); % Col 12 - element dof62
    
    % Row 4 - element dof22
    K(dof22,dof11) = K(dof22,dof11) + ke_transformed(4,1); % Col 1 - element dof11
    K(dof22,dof12) = K(dof22,dof12) + ke_transformed(4,2); % Col 2 - element dof12
    K(dof22,dof21) = K(dof22,dof21) + ke_transformed(4,3); % Col 3 - element dof21
    K(dof22,dof22) = K(dof22,dof22) + ke_transformed(4,4); % Col 4 - element dof22
    K(dof22,dof31) = K(dof22,dof31) + ke_transformed(4,5); % Col 5 - element dof31
    K(dof22,dof32) = K(dof22,dof32) + ke_transformed(4,6); % Col 6 - element dof32
    K(dof22,dof41) = K(dof22,dof41) + ke_transformed(4,7); % Col 7 - element dof41
    K(dof22,dof42) = K(dof22,dof42) + ke_transformed(4,8); % Col 8 - element dof42
    K(dof22,dof51) = K(dof22,dof51) + ke_transformed(4,9); % Col 9 - element dof51
    K(dof22,dof52) = K(dof22,dof52) + ke_transformed(4,10); % Col 10 - element dof52
    K(dof22,dof61) = K(dof22,dof61) + ke_transformed(4,11); % Col 11 - element dof61
    K(dof22,dof62) = K(dof22,dof62) + ke_transformed(4,12); % Col 12 - element dof62
    
    % Row 5 - element dof31
    K(dof31,dof11) = K(dof31,dof11) + ke_transformed(5,1); % Col 1 - element dof11
    K(dof31,dof12) = K(dof31,dof12) + ke_transformed(5,2); % Col 2 - element dof12
    K(dof31,dof21) = K(dof31,dof21) + ke_transformed(5,3); % Col 3 - element dof21
    K(dof31,dof22) = K(dof31,dof22) + ke_transformed(5,4); % Col 4 - element dof22
    K(dof31,dof31) = K(dof31,dof31) + ke_transformed(5,5); % Col 5 - element dof31
    K(dof31,dof32) = K(dof31,dof32) + ke_transformed(5,6); % Col 6 - element dof32
    K(dof31,dof41) = K(dof31,dof41) + ke_transformed(5,7); % Col 7 - element dof41
    K(dof31,dof42) = K(dof31,dof42) + ke_transformed(5,8); % Col 8 - element dof42
    K(dof31,dof51) = K(dof31,dof51) + ke_transformed(5,9); % Col 9 - element dof51
    K(dof31,dof52) = K(dof31,dof52) + ke_transformed(5,10); % Col 10 - element dof52
    K(dof31,dof61) = K(dof31,dof61) + ke_transformed(5,11); % Col 11 - element dof61
    K(dof31,dof62) = K(dof31,dof62) + ke_transformed(5,12); % Col 12 - element dof62
    
    % Row 6 - element dof32
    K(dof32,dof11) = K(dof32,dof11) + ke_transformed(6,1); % Col 1 - element dof11
    K(dof32,dof12) = K(dof32,dof12) + ke_transformed(6,2); % Col 2 - element dof12
    K(dof32,dof21) = K(dof32,dof21) + ke_transformed(6,3); % Col 3 - element dof21
    K(dof32,dof22) = K(dof32,dof22) + ke_transformed(6,4); % Col 4 - element dof22
    K(dof32,dof31) = K(dof32,dof31) + ke_transformed(6,5); % Col 5 - element dof31
    K(dof32,dof32) = K(dof32,dof32) + ke_transformed(6,6); % Col 6 - element dof32
    K(dof32,dof41) = K(dof32,dof41) + ke_transformed(6,7); % Col 7 - element dof41
    K(dof32,dof42) = K(dof32,dof42) + ke_transformed(6,8); % Col 8 - element dof42
    K(dof32,dof51) = K(dof32,dof51) + ke_transformed(6,9); % Col 9 - element dof51
    K(dof32,dof52) = K(dof32,dof52) + ke_transformed(6,10); % Col 10 - element dof52
    K(dof32,dof61) = K(dof32,dof61) + ke_transformed(6,11); % Col 11 - element dof61
    K(dof32,dof62) = K(dof32,dof62) + ke_transformed(6,12); % Col 12 - element dof62
    
    % Row 7 - element dof41
    K(dof41,dof11) = K(dof41,dof11) + ke_transformed(7,1); % Col 1 - element dof11
    K(dof41,dof12) = K(dof41,dof12) + ke_transformed(7,2); % Col 2 - element dof12
    K(dof41,dof21) = K(dof41,dof21) + ke_transformed(7,3); % Col 3 - element dof21
    K(dof41,dof22) = K(dof41,dof22) + ke_transformed(7,4); % Col 4 - element dof22
    K(dof41,dof31) = K(dof41,dof31) + ke_transformed(7,5); % Col 5 - element dof31
    K(dof41,dof32) = K(dof41,dof32) + ke_transformed(7,6); % Col 6 - element dof32
    K(dof41,dof41) = K(dof41,dof41) + ke_transformed(7,7); % Col 7 - element dof41
    K(dof41,dof42) = K(dof41,dof42) + ke_transformed(7,8); % Col 8 - element dof42
    K(dof41,dof51) = K(dof41,dof51) + ke_transformed(7,9); % Col 9 - element dof51
    K(dof41,dof52) = K(dof41,dof52) + ke_transformed(7,10); % Col 10 - element dof52
    K(dof41,dof61) = K(dof41,dof61) + ke_transformed(7,11); % Col 11 - element dof61
    K(dof41,dof62) = K(dof41,dof62) + ke_transformed(7,12); % Col 12 - element dof62
    
    % Row 8 - element dof42
    K(dof42,dof11) = K(dof42,dof11) + ke_transformed(8,1); % Col 1 - element dof11
    K(dof42,dof12) = K(dof42,dof12) + ke_transformed(8,2); % Col 2 - element dof12
    K(dof42,dof21) = K(dof42,dof21) + ke_transformed(8,3); % Col 3 - element dof21
    K(dof42,dof22) = K(dof42,dof22) + ke_transformed(8,4); % Col 4 - element dof22
    K(dof42,dof31) = K(dof42,dof31) + ke_transformed(8,5); % Col 5 - element dof31
    K(dof42,dof32) = K(dof42,dof32) + ke_transformed(8,6); % Col 6 - element dof32
    K(dof42,dof41) = K(dof42,dof41) + ke_transformed(8,7); % Col 7 - element dof41
    K(dof42,dof42) = K(dof42,dof42) + ke_transformed(8,8); % Col 8 - element dof42
    K(dof42,dof51) = K(dof42,dof51) + ke_transformed(8,9); % Col 9 - element dof51
    K(dof42,dof52) = K(dof42,dof52) + ke_transformed(8,10); % Col 10 - element dof52
    K(dof42,dof61) = K(dof42,dof61) + ke_transformed(8,11); % Col 11 - element dof61
    K(dof42,dof62) = K(dof42,dof62) + ke_transformed(8,12); % Col 12 - element dof62
    
    % Row 9 - element dof51
    K(dof51,dof11) = K(dof51,dof11) + ke_transformed(9,1); % Col 1 - element dof11
    K(dof51,dof12) = K(dof51,dof12) + ke_transformed(9,2); % Col 2 - element dof12
    K(dof51,dof21) = K(dof51,dof21) + ke_transformed(9,3); % Col 3 - element dof21
    K(dof51,dof22) = K(dof51,dof22) + ke_transformed(9,4); % Col 4 - element dof22
    K(dof51,dof31) = K(dof51,dof31) + ke_transformed(9,5); % Col 5 - element dof31
    K(dof51,dof32) = K(dof51,dof32) + ke_transformed(9,6); % Col 6 - element dof32
    K(dof51,dof41) = K(dof51,dof41) + ke_transformed(9,7); % Col 7 - element dof41
    K(dof51,dof42) = K(dof51,dof42) + ke_transformed(9,8); % Col 8 - element dof42
    K(dof51,dof51) = K(dof51,dof51) + ke_transformed(9,9); % Col 9 - element dof51
    K(dof51,dof52) = K(dof51,dof52) + ke_transformed(9,10); % Col 10 - element dof52
    K(dof51,dof61) = K(dof51,dof61) + ke_transformed(9,11); % Col 11 - element dof61
    K(dof51,dof62) = K(dof51,dof62) + ke_transformed(9,12); % Col 12 - element dof62
    
    % Row 10 - element dof52
    K(dof52,dof11) = K(dof52,dof11) + ke_transformed(10,1); % Col 1 - element dof11
    K(dof52,dof12) = K(dof52,dof12) + ke_transformed(10,2); % Col 2 - element dof12
    K(dof52,dof21) = K(dof52,dof21) + ke_transformed(10,3); % Col 3 - element dof21
    K(dof52,dof22) = K(dof52,dof22) + ke_transformed(10,4); % Col 4 - element dof22
    K(dof52,dof31) = K(dof52,dof31) + ke_transformed(10,5); % Col 5 - element dof31
    K(dof52,dof32) = K(dof52,dof32) + ke_transformed(10,6); % Col 6 - element dof32
    K(dof52,dof41) = K(dof52,dof41) + ke_transformed(10,7); % Col 7 - element dof41
    K(dof52,dof42) = K(dof52,dof42) + ke_transformed(10,8); % Col 8 - element dof42
    K(dof52,dof51) = K(dof52,dof51) + ke_transformed(10,9); % Col 9 - element dof51
    K(dof52,dof52) = K(dof52,dof52) + ke_transformed(10,10); % Col 10 - element dof52
    K(dof52,dof61) = K(dof52,dof61) + ke_transformed(10,11); % Col 11 - element dof61
    K(dof52,dof62) = K(dof52,dof62) + ke_transformed(10,12); % Col 12 - element dof62
    
    % Row 11 - element dof61
    K(dof61,dof11) = K(dof61,dof11) + ke_transformed(11,1); % Col 1 - element dof11
    K(dof61,dof12) = K(dof61,dof12) + ke_transformed(11,2); % Col 2 - element dof12
    K(dof61,dof21) = K(dof61,dof21) + ke_transformed(11,3); % Col 3 - element dof21
    K(dof61,dof22) = K(dof61,dof22) + ke_transformed(11,4); % Col 4 - element dof22
    K(dof61,dof31) = K(dof61,dof31) + ke_transformed(11,5); % Col 5 - element dof31
    K(dof61,dof32) = K(dof61,dof32) + ke_transformed(11,6); % Col 6 - element dof32
    K(dof61,dof41) = K(dof61,dof41) + ke_transformed(11,7); % Col 7 - element dof41
    K(dof61,dof42) = K(dof61,dof42) + ke_transformed(11,8); % Col 8 - element dof42
    K(dof61,dof51) = K(dof61,dof51) + ke_transformed(11,9); % Col 9 - element dof51
    K(dof61,dof52) = K(dof61,dof52) + ke_transformed(11,10); % Col 10 - element dof52
    K(dof61,dof61) = K(dof61,dof61) + ke_transformed(11,11); % Col 11 - element dof61
    K(dof61,dof62) = K(dof61,dof62) + ke_transformed(11,12); % Col 12 - element dof62
    
    % Row 12 - element dof62
    K(dof62,dof11) = K(dof62,dof11) + ke_transformed(12,1); % Col 1 - element dof11
    K(dof62,dof12) = K(dof62,dof12) + ke_transformed(12,2); % Col 2 - element dof12
    K(dof62,dof21) = K(dof62,dof21) + ke_transformed(12,3); % Col 3 - element dof21
    K(dof62,dof22) = K(dof62,dof22) + ke_transformed(12,4); % Col 4 - element dof22
    K(dof62,dof31) = K(dof62,dof31) + ke_transformed(12,5); % Col 5 - element dof31
    K(dof62,dof32) = K(dof62,dof32) + ke_transformed(12,6); % Col 6 - element dof32
    K(dof62,dof41) = K(dof62,dof41) + ke_transformed(12,7); % Col 7 - element dof41
    K(dof62,dof42) = K(dof62,dof42) + ke_transformed(12,8); % Col 8 - element dof42
    K(dof62,dof51) = K(dof62,dof51) + ke_transformed(12,9); % Col 9 - element dof51
    K(dof62,dof52) = K(dof62,dof52) + ke_transformed(12,10); % Col 10 - element dof52
    K(dof62,dof61) = K(dof62,dof61) + ke_transformed(12,11); % Col 11 - element dof61
    K(dof62,dof62) = K(dof62,dof62) + ke_transformed(12,12); % Col 12 - element dof62
    
    
end

% Constructing the global nodal force vector
F = zeros(2*nodes,1); % initialising en empty a 66x1 column vector for convenience
F(24) = -1e3; % The load P acts downwards on node 12 i.e. it affects global dof 24
% There are no other nodal loads to apply

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% SOLVER MODULE %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Specification of submatrices directly, note there is no need to form
% a rearranged K or F explicitly
KRR = K(dofs_restrained,dofs_restrained);
KRF = K(dofs_restrained,dofs_free);
KFR = K(dofs_free,dofs_restrained);
KFF = K(dofs_free,dofs_free);
fF = F(dofs_free);
% You cannot yet form fR as you do not know what the base reaction is.
% Also, you can even avoid formulating KRR etc. separately and just access
% the requires sub-matrices of K and f directly in what follows.

% Solution for the unknown nodal dofs
uR = zeros(length(dofs_restrained),1); % BC - zero displacement on nodes 1,2,3,4,5,6,7,8,11,12
uF = KFF\(fF - KFR*uR); % 1st matrix equation
U = zeros(2*nodes,1);
U(dofs_restrained) = uR;
U(dofs_free) = uF; % full nodal dof vector

% Solution for the unknown reactions
fR = KRF*uF + KRR*uR; % 2nd matrix equation
F(dofs_restrained) = fR; % full nodal force vector

% Note that this portion is misleading in its minimalism. We exploit the
% fact that Matlab has efficient routines for matrix operations, and we can
% manipulate matrices just like simple algebra. Additionally, the matrices
% are small and the analysis is linear, so the 'inversion' of KFF is very
% fast. Do not be fooled - for large nonlinear models this step can take
% the lion's share of modelling time. Hours, if not days. Just ask a PhD
% student!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% POST-PROCESSOR MODULE %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Updating nodal coordinates after deformation
% Creating two vectors - one with real size deformed coordinates and one
% with amplified deformed coordinate (for plotting purposes)
NODES.new_coords = zeros(size(NODES.coords)); 
NODES.amp_coords = zeros(size(NODES.coords)); 
amp = 100; % amplification factor for plotting purposes only 
for I = 1:size(NODES.coords,1)
    for J = 1:size(NODES.coords,2)    
        NODES.amp_coords(I,J) = NODES.coords(I,J) + U(NODES.dofs(I,J))*amp;
        NODES.new_coords(I,J) = NODES.coords(I,J) + U(NODES.dofs(I,J));
    end
end

% Plotting
figure('units','normalized','outerposition',[0 0 1 1]); hold all; grid on; tol = 1e-3;
xmin = min(NODES.amp_coords(:,1)); xmax = max(NODES.amp_coords(:,1)); difx = xmax - xmin;
ymin = min(NODES.amp_coords(:,2)); ymax = max(NODES.amp_coords(:,2)); dify = ymax - ymin; fac = 0.25;
axis([xmin-difx*fac  xmax+difx*fac  ymin-dify*fac  ymax+dify*fac]);
% Note that if the 'squished' structural shape bothers you, replace the
% above line with 'axis equal'

for EL = 1:elements
    n1 = ELEMENTS(EL,1); n2 = ELEMENTS(EL,2); n3 = ELEMENTS(EL,3); % identify element node numbers
    n4 = ELEMENTS(EL,4); n5 = ELEMENTS(EL,5); n6 = ELEMENTS(EL,6);
%     Plotting original structure
    x1 = NODES.coords(n1,1); y1 = NODES.coords(n1,2); % element node 1 - x,y original coordinates
    x2 = NODES.coords(n2,1); y2 = NODES.coords(n2,2); % element node 2 - x,y original coordinates
    x3 = NODES.coords(n3,1); y3 = NODES.coords(n3,2); % element node 3 - x,y original coordinates
    x4 = NODES.coords(n4,1); y4 = NODES.coords(n4,2); % element node 4 - x,y original coordinates
    x5 = NODES.coords(n5,1); y5 = NODES.coords(n5,2); % element node 5 - x,y original coordinates
    x6 = NODES.coords(n6,1); y6 = NODES.coords(n6,2); % element node 6 - x,y original coordinates

    alpha = atan2(y2-y1,x2-x1); % angle of inclination relative to the POSITIVE x axis direction
    
    patch([x1,x4,x2,x5,x3,x6],[y1,y4,y2,y5,y3,y6],[0.5 0.5 0.5]);
    
    
%     Check on changes in member lengths and plotting amplified deformed structure
    x1_amp = NODES.amp_coords(n1,1); y1_amp = NODES.amp_coords(n1,2); % element node 1 - x,y amplified deformed coordinates
    x2_amp = NODES.amp_coords(n2,1); y2_amp = NODES.amp_coords(n2,2); % element node 2 - x,y amplified deformed coordinates
    x3_amp = NODES.amp_coords(n3,1); y3_amp = NODES.amp_coords(n3,2); % element node 3 - x,y amplified deformed coordinates
    x4_amp = NODES.amp_coords(n4,1); y4_amp = NODES.amp_coords(n4,2); % element node 1 - x,y amplified deformed coordinates
    x5_amp = NODES.amp_coords(n5,1); y5_amp = NODES.amp_coords(n5,2); % element node 2 - x,y amplified deformed coordinates
    x6_amp = NODES.amp_coords(n6,1); y6_amp = NODES.amp_coords(n6,2); % element node 3 - x,y amplified deformed coordinates

%     patch([x1_amp,x2_amp,x3_amp,x4_amp,x5_amp,x6_amp],[y1_amp,y2_amp,y3_amp,y4_amp,y5_amp,y6_amp],'r');
    
    
%     Plotting nodes last!
    plot(x1,y1,'ko','Markersize',7,'MarkerFaceColor','w');
    plot(x4,y4,'ko','Markersize',7,'MarkerFaceColor','w');
    plot(x2,y2,'ko','Markersize',7,'MarkerFaceColor','w');
    plot(x5,y5,'ko','Markersize',7,'MarkerFaceColor','w');
    plot(x3,y3,'ko','Markersize',7,'MarkerFaceColor','w');
    plot(x6,y6,'ko','Markersize',7,'MarkerFaceColor','w');
%     plot(x1_amp,y1_amp,'ko','Markersize',7,'MarkerFaceColor','y');  
%     plot(x2_amp,y2_amp,'ko','Markersize',7,'MarkerFaceColor','y');
%     plot(x3_amp,y3_amp,'ko','Markersize',7,'MarkerFaceColor','y');
%     plot(x4_amp,y4_amp,'ko','Markersize',7,'MarkerFaceColor','y');  
%     plot(x5_amp,y5_amp,'ko','Markersize',7,'MarkerFaceColor','y');
%     plot(x6_amp,y6_amp,'ko','Markersize',7,'MarkerFaceColor','y');
end
xlabel('x coordinate');
ylabel('y coordinate');
title('Deformed shape')
set(gca,'FontSize',30);

% Printing computed dofs & reactions - this is an important part of the post-processing,
% make sure to include something like this in every analysis that you do.
for dof = 1:length(uF)
    disp(['The value of dof ',num2str(dofs_free(dof)),' is ',num2str(uF(dof))]);    
end
disp(' ');
for react = 1:length(fR)
    disp(['The value of the reaction at dof ',num2str(dofs_restrained(react)),' is ',num2str(fR(react))]);
end
disp(' '); disp('Vertical equilibrium check:');
disp(['Total vertical reactions = ',num2str(fR(2) + fR(4) + fR(6) + fR(8) + fR(10))]);
disp(['Total applied vertical loads = ',num2str(F(12))]);
if abs(fR(2) + fR(4) + fR(6) + fR(8) + fR(10) + F(12)) < 1e-6; disp('Ok.'); end
disp(' '); disp('Horizontal equilibrium check:');
disp(['Total horizontal reactions = ',num2str(fR(1) + fR(3) + fR(5) + fR(7) + fR(9))]);
disp('Total applied horizontal loads = 0');
if abs(fR(1) + fR(3) + fR(5) + fR(7) + fR(9)) < 1e-6; disp('Ok.'); end